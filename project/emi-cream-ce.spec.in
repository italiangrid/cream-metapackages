Summary: This is a dummy package used to install the CREAM node
Name: @PKGNAME@-no-mariadb
Version: @PKGVERSION@
Release: @PKGRELEASE@%{?dist}
License: Apache License 2.0
Vendor: EMI
Group: System Environment/Libraries
Packager: ETICS
BuildArch: noarch
Requires: argus-gsi-pep-callout, bdii, cleanup-grid-accounts
Requires: dynsched-generic, emi-version, fetch-crl,
Requires: apel-parsers, glite-ce-blahp, glite-ce-cream,
#Requires: glite-ce-yaim-cream-ce, glite-yaim-bdii, glite-ce-cream-es,
#Requires: glite-initscript-globus-gridftp
Requires: glite-lb-logger, glite-info-provider-service,
Requires: globus-gridftp-server-progs, globus-proxy-utils, glue-schema, kill-stale-ftp,
Requires: lcas-lcmaps-gt4-interface, lcas-plugins-basic, lcas-plugins-check-executable,
Requires: lcas-plugins-voms, lcg-expiregridmapdir, glexec,
Requires: lcmaps-plugins-verify-proxy, lcmaps-plugins-voms, lcmaps-plugins-basic,
#Requires: lcmaps, lcmaps-without-gsi,
Requires: @TOMCATPKG@, mysql-connector-java, canl-java-tomcat
Conflicts: @PKGNAME@
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)
AutoReqProv: yes
Source: @PKGNAME@.tar.gz

%description
This is a dummy package used to install the CREAM node

%prep

%setup -c -q

%install
rm -rf %{buildroot}
mkdir -p %{buildroot}/lib/systemd/system/
mkdir -p %{buildroot}/etc/systemd/system/tomcat.service.d/
mkdir -p %{buildroot}/etc/systemd/system/glite-lb-logd.service.d/
mkdir -p %{buildroot}/etc/systemd/system/glite-ce-blah-parser.service.d/
printf "[Unit]
Description=Master service for CREAM CE
Requires=tomcat.service glite-lb-logd.service glite-ce-blah-parser.service
" > %{buildroot}/lib/systemd/system/glite-services.target
printf "[Unit]
PartOf=glite-services.target
" > %{buildroot}/etc/systemd/system/tomcat.service.d/10-glite-services.conf
printf "[Unit]
PartOf=glite-services.target
" > %{buildroot}/etc/systemd/system/glite-lb-logd.service.d/10-glite-services.conf
printf "[Unit]
PartOf=glite-services.target
" > %{buildroot}/etc/systemd/system/glite-ce-blah-parser.service.d/10-glite-services.conf

%clean
rm -rf %{buildroot}

%files
%defattr(-,root,root)
/lib/systemd/system/glite-services.target
/etc/systemd/system/tomcat.service.d/10-glite-services.conf
/etc/systemd/system/glite-lb-logd.service.d/10-glite-services.conf
/etc/systemd/system/glite-ce-blah-parser.service.d/10-glite-services.conf


%package -n @PKGNAME@
Summary: This is a dummy package used to install the CREAM node
Group: System Environment/Libraries
Requires: argus-gsi-pep-callout, bdii, cleanup-grid-accounts
Requires: dynsched-generic, emi-version, fetch-crl,
Requires: apel-parsers, glite-ce-blahp, glite-ce-cream,
#Requires: glite-ce-yaim-cream-ce, glite-yaim-bdii, glite-ce-cream-es,
#Requires: glite-initscript-globus-gridftp
Requires: glite-lb-logger, glite-info-provider-service,
Requires: globus-gridftp-server-progs, globus-proxy-utils, glue-schema, kill-stale-ftp,
Requires: lcas-lcmaps-gt4-interface, lcas-plugins-basic, lcas-plugins-check-executable,
Requires: lcas-plugins-voms, lcg-expiregridmapdir, glexec,
Requires: lcmaps-plugins-verify-proxy, lcmaps-plugins-voms, lcmaps-plugins-basic,
#Requires: lcmaps, lcmaps-without-gsi
Requires: @TOMCATPKG@, mysql-connector-java, canl-java-tomcat
Requires: mariadb-server
Conflicts: @PKGNAME@-no-mariadb

%description -n @PKGNAME@
This is a dummy package used to install the CREAM node

%files -n @PKGNAME@
%defattr(-,root,root)
/lib/systemd/system/glite-services.target
/etc/systemd/system/tomcat.service.d/10-glite-services.conf
/etc/systemd/system/glite-lb-logd.service.d/10-glite-services.conf
/etc/systemd/system/glite-ce-blah-parser.service.d/10-glite-services.conf

%changelog
* Fri Dec 5 2014 CREAM group <cream-support@lists.infn.it> - @PKGVERSION@-@PKGRELEASE@
- CREAM CE metapackages for different mysql versions

* Mon Jun 30 2014 CREAM group <cream-support@lists.infn.it> - 1.2.3-1
- Removed dependency on voms-clients

* Fri Aug 31 2012 CREAM group <cream-support@lists.infn.it> - 1.2.2-2
- New major release

